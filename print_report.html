<html>
<head>
<title>Forager: Report</title>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.0.js"></script>
<script type="text/javascript" src="sortableplugin/js/sortable.js"></script> 
<script type="text/javascript" src="js/session.js"></script>
<script type="text/javascript" src="listjs/list.js"></script>
<script type="text/javascript" src="js/report.js"></script>
<script type="text/javascript" src="js/print_submit.js"></script>

</head>
<body>

<div class="container_fluid">
<div class="row">
<div class="col-lg-12">
<div class="panel">
  <div class="panel_body">
  </div>
  <!--<div class="panel_heading">
    Error Report for: "this report"
  </div>-->
  <div class="panel_body" id="report_info">
    
  </div>  
  <div class="panel_body">
  <!--TODO: display pages scanned, num errors, run time, average errors per page  -->
  <div class="panel_heading">
    Errors
  </div>
<script type="text/javascript">
</script>
  
  
    <br><center>
    <img id="table-loading" src="img/ajax-loader.gif" />
    </center>

      <div class="items">
        <table id="goups_background" class="sortable-theme-spsu error_result_table" data-sortable>
            <thead>
              <tr class="tr_non_clickable"id="goups_background">
              
          <th id="main_data" class="tabel_title" style="color:#FFC425;">
          URL

          </th>
          <th id="side_data_l" class="tabel_title">
          Domain
          </th>
          <th id="side_data_l" class="tabel_title">
          Source Page
          </th>

          <th id="side_data_s" class="tabel_title">
          Error Type
          </th>
          <th id="side_data_l" class="tabel_title">
          Error Message
          </th>
          
          </tr>
            </thead>
            <tbody id="error_display">
            

              
            
            </tbody>
              
          </table>

  </div>
  </div>
  </div>
  
  </div>
  <script type="text/javascript">
  $(document).ready(function(){
    
    Session.check();

    var str = "Logged in as: " + Session.name;
    $("#user_logged_in").html(str);
    console.log(getFromUrl("id"));
    var rTable = document.querySelector('#error_display');
    var tableTempl = document.querySelector('#scan_table').innerHTML;
     var detailsPos = document.querySelector('#report_info');
    var detailsTempl = document.querySelector('#scan_details').innerHTML;
    allReports.showReportErrors(tableTempl, rTable, getFromUrl("id"));
    allReports.showReportDetails(detailsTempl, detailsPos, getFromUrl("id"));
    var rList = document.querySelector('#reports_menu');
    allReports.getReportsList(rList);
    listFilter( $("#list"), $("#domain1"));
    listFilter( $("#list2"), $("#domain2"));
    tableFilter($(".error_result_table"), $("#table_search"));

  });
  $('.collapse > li h2').click(function() {
    $(this).parent().find('div').first().toggle();
  $(this).toggleClass("special");
  });
  $("#log_out").click(function(event){
    Session.logout();
  });
  </script>

  <script type="text/javascript" id="error_table">
    <tr class="tr_clickable" id="goups_background">
          <td id="main_data">{{url}}
          </td>
          
          <td id="side_data_s">{{type}}
          </td>
        </tr>
  </script>
  <script type="text/javascript" id="scan_details_olde_time">
  <center><h1>{{name}}</h1></center>
    <table id="groups_background" id="report_details">
        <tr class="tr_non_clickable" id ="groups_background">
            <th id= "side_data_l" class="tabel_title" style="color:#FFC425;">
              Date/Time: {{startTime}}
            </th>
            <th id= "side_data_l" class="tabel_title" style="color:#FFC425;">
            Scan Time: {{time}}
            </th>
            
            <th id= "side_data_l" class="tabel_title" style="color:#FFC425;">
            Scanned Pages: {{pages}}
            </th>
            <th id= "side_data_l" class="tabel_title" style="color:#FFC425;">
            Total Errors: {{errors}}
            </th>
            <th id= "side_data_l" class="tabel_title" style="color:#FFC425;">
            Average errors per Page: {{avgErr}}
            </th>
        </tr>   
    </table>
  </script>
  <script type="template" id="scan_details">

  <center><h1>{{name}}</h1></center>
  <ul class="list">
    <li>
      <h3 class="title">Total Pages Scanned</h3>
      <p class="data">{{pages}}</p>
    </li>
    <li>
      <h3 class="title">Total Number of Errors</h3>
      <p class="data">{{errors}}</p>
    </li>
    <li>
      <h3 class="title">Elapsed Scan time</h3>
      <p class="data">{{time}}</p>
    </li>
    <li>
      <h3 class="title">Scan Start Time</h3>
      <p class="data">{{startTime}}</p>
    </li>
    <li>
      <h3 class="title">Average Number of Errors Per Page</h3>
      <p class="data">{{avgErr}}</p>
    </li>
    </ul>
    </script>
  <script type="template" id="scan_table">
  <tr class="tr_clickable" id="goups_background">
          <td id="main_data" style="max-width: 350px; word-wrap: break-word;"><a href="{{url}}">{{url}}</a>
          </td>
          <td id="side_data_l" style="max-width: 350px ;word-wrap: break-word;">{{domain}}
          </td>
          <td id="side_data_l" style="max-width: 350px ;word-wrap: break-word;"><a href="{{source}}">{{source}}</a>
          </td>
          
          <td id="side_data_s">{{type}}
          </td>
          <td id="side_data_l">{{message}}
          </td>
        </tr>
  </script>
  <script type="text/javascript" id="domain_table">
   <li>
   <h2> {{domain}} {{numpages}}, {{#errors}}, {{%errors}}</h2>
      <div class="content">
      <ul>
        {{pages_content}}
        </ul>
      </div>
    
    </li>
  </script>
 
  </script>

  <script type="text/javascript">
       $("#print_report").on("submit", function(event){
          //create two variables to store dropdown 1&2
          event.preventDefault();
          var id1 = getFromUrl("id");

            //send to compare_submit.js
            Print.Submit(id1);
        });
      
    </script>

  <link href='http://fonts.googleapis.com/css?family=Ubuntu:500' rel='stylesheet' type='text/css'>
  </body>
  </html>